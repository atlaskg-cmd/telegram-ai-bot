# üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å WhatsApp webhook

## üìç –î–≤–∞ —Å–ø–æ—Å–æ–±–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### ‚úÖ –°–ø–æ—Å–æ–± 1: –õ–æ–∫–∞–ª—å–Ω–æ (–Ω–∞ —Å–≤–æ—ë–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ) - –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

#### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install requests python-dotenv
```

#### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env`
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```env
GREEN_API_ID=–≤–∞—à_id_–∏–Ω—Å—Ç–∞–Ω—Å–∞
GREEN_API_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
RAILWAY_PUBLIC_DOMAIN=–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.up.railway.app
```

**–ì–¥–µ –≤–∑—è—Ç—å –¥–∞–Ω–Ω—ã–µ:**
- `GREEN_API_ID` –∏ `GREEN_API_TOKEN` - –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ Green API (https://console.green-api.com/)
- `RAILWAY_PUBLIC_DOMAIN` - –∏–∑ Railway Dashboard ‚Üí Settings ‚Üí Public Domain (–±–µ–∑ https://)

#### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
```bash
python setup_whatsapp_webhook.py
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
- –°–∫—Ä–∏–ø—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ Green API
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç webhook URL
- –í–∫–ª—é—á–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç —Å—Ç–∞—Ç—É—Å –∏–Ω—Å—Ç–∞–Ω—Å–∞ (QR-–∫–æ–¥ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –Ω–µ—Ç)
- –ü–æ–∫–∞–∂–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç

---

### ‚úÖ –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ Railway Console

–ï—Å–ª–∏ —É —Ç–µ–±—è –Ω–µ—Ç Railway CLI, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:

#### –í–∞—Ä–∏–∞–Ω—Ç 2A: Railway Web Console
1. –û—Ç–∫—Ä–æ–π Railway Dashboard (https://railway.app/dashboard)
2. –í—ã–±–µ—Ä–∏ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç (telegram-ai-bot)
3. –û—Ç–∫—Ä–æ–π –≤–∫–ª–∞–¥–∫—É **"Settings"**
4. –í–Ω–∏–∑—É –Ω–∞–∂–º–∏ **"Deploy"** ‚Üí **"Redeploy"** (—á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥)
5. –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø–µ—Ä–µ–π–¥–∏ –≤ **"Logs"**
6. –í –ª–æ–≥–∞—Ö —É–≤–∏–¥–∏—à—å –∫–∞–∫ –±–æ—Ç –∑–∞–ø—É—Å—Ç–∏–ª—Å—è

**–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å:**
- –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, Railway –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä—è–º—É—é –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Python —Å–∫—Ä–∏–ø—Ç–æ–≤
- –ü–æ—ç—Ç–æ–º—É **—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –°–ø–æ—Å–æ–± 1 (–ª–æ–∫–∞–ª—å–Ω–æ)**

#### –í–∞—Ä–∏–∞–Ω—Ç 2B: Railway CLI (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
```bash
railway login
railway link
railway run python setup_whatsapp_webhook.py
```

---

### ‚úÖ –°–ø–æ—Å–æ–± 3: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–±–µ–∑ —Å–∫—Ä–∏–ø—Ç–∞)

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –≤—Ä—É—á–Ω—É—é:

1. –û—Ç–∫—Ä–æ–π https://console.green-api.com/
2. –í—ã–±–µ—Ä–∏ —Å–≤–æ–π –∏–Ω—Å—Ç–∞–Ω—Å
3. –ù–∞–∂–º–∏ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"** (Settings)
4. –ù–∞–π–¥–∏ —Ä–∞–∑–¥–µ–ª **"Webhook URL"**
5. –í–≤–µ–¥–∏: `https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.up.railway.app/webhook-whatsapp`
6. –í–∫–ª—é—á–∏:
   - ‚úÖ Incoming webhook
   - ‚úÖ Outgoing webhook  
   - ‚úÖ State webhook
7. –°–æ—Ö—Ä–∞–Ω–∏

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook –ø—Ä–æ–≤–µ—Ä—å –µ–≥–æ —Ä–∞–±–æ—Ç—É:

### 1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ):
```bash
python diagnose_whatsapp_webhook.py
```

### 2. –õ–æ–≥–∏ Railway:
```bash
railway logs -f
```

–ò–ª–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: Railway Dashboard ‚Üí Logs

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
–û—Ç–ø—Ä–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –Ω–æ–º–µ—Ä WhatsApp –±–æ—Ç–∞:
- `–ø—Ä–∏–≤–µ—Ç` - –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é
- `—é–∞–Ω—å` - –¥–æ–ª–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Å—É–º–º—É

---

## üìã –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

–ü–µ—Ä–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π webhook —É–±–µ–¥–∏—Å—å:

- [ ] Green API credentials –ø–æ–ª—É—á–µ–Ω—ã (ID –∏ TOKEN)
- [ ] QR-–∫–æ–¥ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω –≤ Green API Console
- [ ] Railway variables —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
  - `GREEN_API_ID`
  - `GREEN_API_TOKEN`
  - `TELEGRAM_API_TOKEN`
- [ ] –ë–æ—Ç –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ Railway (–ø–æ—Å–ª–µ–¥–Ω–∏–π push)
- [ ] Railway Public Domain –¥–æ—Å—Ç—É–ø–µ–Ω

---

## ‚ùì FAQ

**Q: –ù—É–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑?**  
A: –ù–µ—Ç! Webhook –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ Green API –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ç–≤–æ–π –±–æ—Ç.

**Q: –ß—Ç–æ –µ—Å–ª–∏ Railway Public Domain –∏–∑–º–µ–Ω–∏—Ç—Å—è?**  
A: –ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑–∞–Ω–æ–≤–æ - –æ–Ω –æ–±–Ω–æ–≤–∏—Ç webhook URL.

**Q: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook**  
A: 
1. –ü—Ä–æ–≤–µ—Ä—å QR-–∫–æ–¥ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω –ª–∏ (Green API Console)
2. –ó–∞–ø—É—Å—Ç–∏ `python diagnose_whatsapp_webhook.py`
3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Railway

**Q: –£ –º–µ–Ω—è –Ω–µ—Ç Python –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ**  
A: –ò—Å–ø–æ–ª—å–∑—É–π **–°–ø–æ—Å–æ–± 3 (—Ä—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)** —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä –≤ Green API Console.

---

## üÜò –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å GREEN_API_ID –∏ GREEN_API_TOKEN –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
2. –£–±–µ–¥–∏—Å—å —á—Ç–æ –∏–Ω—Å—Ç–∞–Ω—Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω (QR-–∫–æ–¥ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω)
3. –ü—Ä–æ–≤–µ—Ä—å RAILWAY_PUBLIC_DOMAIN –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
4. –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ Railway –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
5. –ó–∞–ø—É—Å—Ç–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É: `python diagnose_whatsapp_webhook.py`

---

‚úÖ **–ì–æ—Ç–æ–≤–æ!** –°–ª–µ–¥—É–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏ webhook –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∑–∞ 2 –º–∏–Ω—É—Ç—ã!
